<!--
    Authors: Noah Lanctot, Lois Lanctot
    File: trivia_questions.html
    Description: Create the trivia questions
-->
<include href="views/header.html"></include>

<!-- Main Content -->
<section id="quizForm">
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="create">
                <h1>Create Personality Quiz Questions</h1><hr>
                <form action="#" method="post">

                    <!-- Quiz Title Input -->
                    <div class="questions">
                        <div class="question">
                            <div class="question-title-container">
                                <label for="questionTitle1">Question 1 Title:</label>
                                <input class="question-title" type="text" id="questionTitle1" placeholder="Enter question title">
                            </div>

                            <div class="question-container ml-3">
                                <label for="question1Answer1">Answer Title:</label>
                                <input class="question-text" type="text" id="question1Answer1" placeholder="Enter answer title1">
                            </div>

                            <div class="question-container">
                                <label for="question1Answer2">Answer Title:</label>
                                <input class="question-text" type="text" id="question1Answer2" placeholder="Enter answer title2">
                            </div>

                            <div>
                                <button class="question-button" type="button" onclick="addOption(this)">Add Option</button>
                            </div>
                        </div>
                    </div>



                    <button class="question-button question-float-left" type="button" onclick="addQuestion()">Add Question</button>
                    <button class="question-button question-float-right">Finish Quiz</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        let questionCounter = 1;  // Initialize a counter for questions
        let groupCounter = 1;      // Initialize a counter for question groups

        function addQuestion() {
            // Increment the question and group counters
            questionCounter++;
            groupCounter++;

            // Find the template question element
            let questionTemplate = document.querySelector('.question');

            // Clone the template
            let newQuestionDiv = questionTemplate.cloneNode(true);

            // Update the IDs and labels for the cloned question and its children
            let questionNumber = questionCounter;
            let inputs = newQuestionDiv.querySelectorAll('input, textarea, label');
            inputs.forEach(input => {
                let id = input.getAttribute('id');
                if (id) {
                    input.setAttribute('id', id.replace(/\d+/, questionNumber));
                }
                let forAttr = input.getAttribute('for');
                if (forAttr) {
                    input.setAttribute('for', forAttr.replace(/\d+/, questionNumber));
                }
            });

            // Append the cloned question to the questions container
            let questionsContainer = document.querySelector('.questions');
            questionsContainer.appendChild(newQuestionDiv);
        }

        // Modify the addOption function to add answer inputs instead of options
        function addOption(button) {
            let currentQuestion = button.closest('.question');

            if (currentQuestion) {
                // Count the number of existing answers to determine the index for the new answer
                let existingAnswers = currentQuestion.querySelectorAll('.question-container');
                let newIndex = existingAnswers.length + 1;

                let newAnswerContainer = document.createElement('div');
                newAnswerContainer.className = 'question-container';

                // Get the question number from the current question title
                let questionTitleContainer = currentQuestion.querySelector('.question-title-container');
                let questionTitleLabel = questionTitleContainer ? questionTitleContainer.querySelector('label') : null;
                let questionNumber = questionTitleLabel ? questionTitleLabel.getAttribute('for').match(/\d+/) : '';
                questionNumber = questionNumber ? questionNumber[0] : '';

                // Create new input fields for the answer
                let newAnswerLabel = document.createElement('label');
                newAnswerLabel.setAttribute('for', `question${questionNumber}Answer${newIndex}`);
                newAnswerLabel.textContent = 'Answer Title:';

                let newAnswerInput = document.createElement('input');
                newAnswerInput.className = 'question-text';
                newAnswerInput.type = 'text';
                newAnswerInput.id = `question${questionNumber}Answer${newIndex}`;
                newAnswerInput.placeholder = `Enter answer title${newIndex}`;  // Incremented placeholder

                // Append the new input fields to the container
                newAnswerContainer.appendChild(newAnswerLabel);
                newAnswerContainer.appendChild(newAnswerInput);

                // Insert the new answer container before the button's parent node
                currentQuestion.insertBefore(newAnswerContainer, button.parentNode);
            } else {
                console.error('Error: Unable to find the parent question container.');
            }
        }
    </script>
</section>
</body>
</html>
